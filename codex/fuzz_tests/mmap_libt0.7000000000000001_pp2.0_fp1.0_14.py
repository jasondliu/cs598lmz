import mmap
import numpy as np
import sys
import pandas as pd
import matplotlib.pyplot as plt

# -----------------------------------------------------------------------------

def main(input_fname, output_fname):
    print('input:  %r' % input_fname)
    print('output: %r' % output_fname)
    print()

    # read data
    with open(input_fname, 'r+b') as f:
        mm = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)

        # read header
        if mm.readline() != b'P5\n':
            raise ValueError('Invalid image format!')
        if mm.readline() != b'# Generated by ImageMagick\n':
            raise ValueError('Invalid image format!')
        width, height = (int(x) for x in mm.readline().split(b' ')[:2])
        if mm.readline() != b'255\n':
            raise ValueError('Invalid image format!')

        # read data
