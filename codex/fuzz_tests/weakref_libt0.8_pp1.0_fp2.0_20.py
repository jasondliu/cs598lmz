import weakref

import numpy as np

from climlab import constants as const
from climlab.domain.field import Field
from climlab.utils.thermo import entropy_to_t

O2_c = const.O2_c.copy()
O2_c['units'] = 'ppmv'

class State(object):
    '''The State class stores the state variables of a column model.
    
    A State object is automatically generated by a parent model class.
    For example, the Process class generates a state object with a name ``state``.
    It is also used as a container for StateVariables and DiagnosticVariables.

    The State object has several attributes:

    **state**

        A dictionary with state variables. Keys are names of the state variables.
        The values are dictionaries with the following entries:

        * ``limits`` - a tuple with the lower and upper limits
          (if the variable is physical)
        * ``units`` - a string with the unit (if the variable is physical)
        * ``latex_name`` - a string with the variable name in latex format
          (
